# diary@20221107

## 收到「疫情地区旅居史」短信，无视之
_tags: #covid_

- > _（18:22）_ 您好，经大数据排查，您近7天内有过重点关注的疫情地区旅居史，请您不要外出，不乘坐公交、地铁，不到人员密集场所，并立即向目的地所在社区（村）和单位或所住宾馆报备，按要求落实核酸检测等健康管理措施。如有疑惑，请联系12345热线。【合肥市疫防办】
- > _（21:40）_ 您好，因我公司短信系统故障，导致今日给您错误发送了“近7天内疫情地区旅居史”信息，您接到短信后请不必担心。给您造成困扰，我们深表诚挚的歉意。【合肥移动】
- 收到短信第一反应：官府不满我隔天弹窗，发个短信恐吓一下。
- 虽然知道是假的，心想要有问题官府肯定直接打电话过来，但还是立即查看健康码。绿的，就不理它了。

## Clash 安卓客户端报 X509 错误
_tags: #clash #gfw_

- 问题：`connect error: x509: certificate has expired or is not yet valid`
- 原因：域名证书是自签证书或者域名证书过期了
- 方案：配置`skip-cert-verify: true`
- 参考： [issue-1](https://github.com/Dreamacro/clash/issues/905),
        [issue-2](https://github.com/Dreamacro/clash/issues/414),
        [clash config](https://github.com/Dreamacro/clash/wiki/configuration)

## [分布式数据库 - 实战场景分析](https://www.cnblogs.com/Finley/p/16827147.html)
_tags: #database #distributed_

- 分布式系统解决的实际问题：
  - 用廉价的、普通的机器完成单个计算机无法完成的计算、存储任务。
  - 通过多机备份避免单机故障。
  - 通过增加或减少机器数量，灵活调整系统的吞吐量。
- 分布式数据库的技术思路，无外乎 **数据分片** 和 **副本**。
- 数据分片
  - 数据再平衡：将负载从集群中的一个节点向另一个节点移动的过程。
    - 一致性哈希：将整数空间连成一个环，partition_key 沿顺时针行走，存储到遇到的第一个节点。
  - 跨节点查询时，分页器 `limit x offset y` 需要查出每个节点的 `x+y` 个数据，再混起来排序。
  - 分布式事务
    - TCC (try-confirm-catch) 事务：预留并锁定事务所需资源，确认或撤销。
    - Saga 事务：将一个大事务拆分成多个有序的可撤销的子事务，顺序的执行子事务，
                如果某个步骤失败，则根据相反顺序一次执行一次撤销操作。
- 副本
  - 主库运行长时间后添加从库，有大规模数据积累。
    - 如果保存和传输完整的写入日记，浪费资源和时间。
    - 主库定期生成快照，新从库先导入快照再按日志执行同步。
  - 从节点提升为主节点时，如果原来的主节点刚刚提交了事务但数据未同步，有错误数据风险。
  - 选举主节点的主流协议：Gossip vs Raft


## [企业内部开源分析](https://www.cnblogs.com/laofo/p/16867626.html)
_tags: #open-source #enterprise_

- 开源社区：由拥有共同兴趣爱好的人所组成
  - 有共同的兴趣爱好，自由加入退出
  - 开放式交流空间，工作内容和成果是透明的
  - 开放式协作：平等、自组织、精英领导
- 企业：以盈利为目的的经济组织 - 拥有「共同赚钱的爱好」
  - 以劳动合同为组织基础
  - 部分开放式交流
  - 分层次的组织架构，有考核、管理、指导
- 企业内部开源：建立类似开源文化，在企业内部开发专有软件。需具备条件：
  - 已经具备一定功能，仍需添加小需求的维护性项目
  - 对时限没有严格要求的小项目
  - 公司氛围是宽松的，员工有“闲”
  - 公司的代码评审做得很好
  - 支撑的基础设施相对完善，不需要更多其它角色介入（比如设计师、QA等）
